<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Lista de Productos</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
	<style>
		/* Estilos generales */
		body {
			font-family: Arial, sans-serif;
			margin: 0;
			padding: 0;
			transition: background-color 0.3s, color 0.3s;
		}

		/* Barra de navegación estilo WhatsApp */
		.navbar-bottom {
			position: fixed;
			bottom: 0;
			left: 0;
			width: 100%;
			background-color: #ffffff;
			box-shadow: 0 -1px 5px rgba(0, 0, 0, 0.2);
			display: flex;
			justify-content: space-around;
			padding: 10px 0;
			z-index: 1000;
			transition: background-color 0.3s ease;
		}

		.navbar-bottom a {
			text-align: center;
			flex: 1;
			color: #000;
			text-decoration: none;
			font-size: 14px;
		}

		.navbar-bottom a i {
			display: block;
			font-size: 20px;
			margin-bottom: 5px;
		}

		/* Tema oscuro para el contenido */
		[data-theme="dark"] body {
			background-color: #121212;
			color: white;
		}

		[data-theme="dark"] .container {
			background-color: #333;
			color: white;
		}

		[data-theme="dark"] .table {
			border-color: #444;
		}

		[data-theme="dark"] .table th {
			background-color: #555;
		}

		[data-theme="dark"] .table td {
			background-color: #444;
		}

		/* Solo mostrar íconos en pantallas pequeñas */
		@media (max-width: 768px) {
			.navbar-bottom a span {
				display: none;
			}
		}

		/* Mostrar íconos y texto en pantallas grandes */
		@media (min-width: 769px) {
			.navbar-bottom a span {
				display: inline-block;
			}
		}

		/* Estilos para la tabla */
		.container {
			padding-bottom: 60px;
			padding: 20px;
		}

		.input-group {
			display: flex;
			margin-bottom: 20px;
		}

		.input-group input {
			flex: 1;
			padding: 10px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 4px;
		}

		.input-group button {
			padding: 10px 15px;
			background-color: #007bff;
			color: white;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}

		.input-group button:hover {
			background-color: #0056b3;
		}

		/* Estilo tabla similar a Bootstrap */
		.table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 20px;
		}

		.table th, .table td {
			padding: 12px 15px;
			text-align: left;
			border: 1px solid #ddd;
		}

		.table th {
			background-color: #f4f4f4;
			color: #333;
		}

		.table tr:nth-child(even) {
			background-color: #f9f9f9;
		}

		.table tr:hover {
			background-color: #f1f1f1;
		}

		.table tfoot td {
			font-weight: bold;
		}

		.table-responsive {
			overflow-x: auto;
		}
	</style>
</head>
<body>
	<!-- Barra de navegación estilo WhatsApp -->
	<div class="navbar-bottom">
		<a href="index.html">
			<i class="fas fa-home"></i>
			<span>Inicio</span>
		</a>
		<a href="precios.html">
			<i class="fas fa-tag"></i>
			<span>Precios</span>
		</a>
		<a href="#">
			<i class="fas fa-info-circle"></i>
			<span>Info</span>
		</a>
		<a href="#">
			<i class="fas fa-cog"></i>
			<span>Configuración</span>
		</a>
	</div>

	<!-- Contenido principal -->
	<div class="container">
		<div class="input-group">
			<input type="text" id="bus" placeholder="Escribe aquí para filtrar">
			<button id="busc" type="button">
				<i class="fas fa-microphone"></i>
			</button>
		</div>

		<div class="table-responsive">
			<table class="table">
				<thead>
					<tr>
						<th>Artículo</th>
						<th>Descripción</th>
						<th>Cantidad</th>
					</tr>
				</thead>
				<tfoot>
					<tr>
						<td colspan="2">Total</td>
						<td id="total"></td>
					</tr>
				</tfoot>
				<tbody id="res"></tbody>
			</table>
		</div>
	</div>

	<!-- Scripts -->
	<script>
		// Función para cargar productos desde JSON
		function cargarProductos() {
			fetch("productos.json")
				.then(response => response.json())
				.then(data => {
					let contenido = "";
					let total = 0;
					data.forEach(function(producto) {
						contenido += `<tr>
										<td>${producto.uno}</td>
										<td>${producto.dos}</td>
										<td>${producto.tres}</td>
									  </tr>`;
						total += parseInt(producto.tres);
					});
					document.getElementById("res").innerHTML = contenido;
					document.getElementById("total").textContent = total;
				});
		}

		// Filtrar productos
		function filtrarProductos() {
			const busqueda = document.getElementById("bus").value.toLowerCase();
			const filas = document.querySelectorAll("#res tr");

			filas.forEach(function(fila) {
				const descripcion = fila.cells[1].textContent.toLowerCase();
				if (descripcion.indexOf(busqueda) === -1) {
					fila.style.display = "none";
				} else {
					fila.style.display = "";
				}
			});
		}

		// Cambio de tema y guardar en localStorage
		function toggleTheme() {
			const currentTheme = localStorage.getItem('theme') || 'light';
			const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
			document.body.setAttribute('data-theme', newTheme);
			localStorage.setItem('theme', newTheme);
		}

		// Cargar tema desde localStorage al iniciar
		document.addEventListener('DOMContentLoaded', function () {
			const savedTheme = localStorage.getItem('theme') || 'light';
			document.body.setAttribute('data-theme', savedTheme);

			cargarProductos();
			document.getElementById("bus").addEventListener("input", filtrarProductos);

			// Crear y añadir el botón de cambio de tema
			const themeButton = document.createElement('button');
			themeButton.textContent = 'Cambiar tema';
			themeButton.style.position = 'fixed';
			themeButton.style.top = '10px';
			themeButton.style.right = '10px';
			themeButton.style.padding = '10px';
			themeButton.style.cursor = 'pointer';
			themeButton.onclick = toggleTheme;
			document.body.appendChild(themeButton);
		});
	</script>

    <!-- Registrar el service worker -->
    <script>
        if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./service-worker.js')
        .then((registration) => {
            console.log('[Service Worker] Registrado con éxito:', registration);

            // Detecta un nuevo SW esperando para activarse
            registration.onupdatefound = () => {
                const newSW = registration.installing;
                newSW.onstatechange = () => {
                    if (newSW.state === 'installed') {
                        if (navigator.serviceWorker.controller) {
                            // Notificar al usuario que hay una actualización disponible
                            alert('Hay una nueva versión de la aplicación. Recarga la página para aplicar los cambios.');
                        }
                    }
                };
            };
        })
        .catch((error) => {
            console.error('[Service Worker] Error al registrar:', error);
        });
}
    </script>

</body>
</html>
